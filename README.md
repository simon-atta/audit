# Audit

This Repo is used to log audit for any data operation accross the system. i.e. Entity Country have been change by user X at this time.

This Repo will be mainly used to track admin / back office users operations.

1. Microservice will publish event for CREATE, UPDATE, DELETE of any entity. aduit-common has all model, mapper need to be used by microserice

2. In case of RabbitMQ is down microservice will save event to database, audit-common has all code need to be used, you just need to enable @EnableFailedAuditHandler in the application starter.

3. audit-service has schudler which will read from failed events database and convert to the main database.


![https://github.com/simon-atta/audit/blob/386a072ed7e1b02e825f728a0c72c08c47db24bf/Audit.png](https://github.com/simon-atta/audit/blob/386a072ed7e1b02e825f728a0c72c08c47db24bf/Audit.png)

https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&page-id=vYGWXNYezrYDNnuVoNH6&title=Untitled%20Diagram.png#R%3Cmxfile%3E%3Cdiagram%20id%3D%22oT7G2yLPGPGtUfCysM-3%22%20name%3D%22Page-1%22%3E7Z39c6K6Gsf%2Fms7svTM9Q8JL4Ecq7K73Wu1Ruy%2FnF4cqrd5F6UG6256%2F%2FoISNAERlLgJZXZ2KjEBEpKPT77Pk3Ald5avnwLneX7rz1zvCkqz1yvZuoIQqkCN%2FsQpb9sUoCFjm%2FIULGZJ2i5htPjHTRKlJPVlMXPXRMbQ971w8UwmTv3Vyp2GRJoTBP4vMtuj75FXfXae3EzCaOp42dSvi1k4T1KBZuy%2B%2BOwunubJpXWItl8sHZw5qcl67sz8X3tJsn0ldwLfD7eflq8d14tbD7fLttzHA9%2BmNxa4q7BMgf5iIT3%2B%2BddQ69nO%2F96%2BImX88%2B%2Fr5Cw%2FHe8lqfAV1LzofDfP8S2Hb0k7aH%2B%2FxPd5s3SCp8XqSjal59f08Dr0n6MkZZMUuq%2FhteMtnuJc0%2Bje3CBK3Z0h%2BvSU%2FN1c5wEnmHd3vW7HHHcH%2Fcn4%2B52NM0Q1eqALRWnPdNo8iO8YdyB8ObB%2F5Y90mWOVjL7G%2F7e18xYr93qePG8T%2FKEdqJvUGVjRUzA3bRtM504AP0BVjTtq9PlfaeUD4qakvnlrT8zhiQXt%2FvGC%2FLdc19rWYvWyfHCDD8A4cO%2BQuAP40w3CRTRuzW3XszZ98ibpiJbnPsal%2FCjXo7cZhY%2BLaHTIN4%2F%2BKkyoA5Tk%2BKOzXHgxsD673k83PmvcSOHSizNFHwP%2FZTVz42ElRUfpuI4Ppv5yMU0%2Be86D69040x9PmwId3%2FOjoWCt%2FJUbFwsD%2F0fKFJBWaX9A49EZVc193UtKBvgn11%2B6YfAWZUm%2B1RW4LZLg9hpKCYB%2F7eCVEmm%2Bxy0gJ4lOAsyn9OQ7pkQfEqxUQAzkBzGWfWf3Lbvf%2BT6x7LHZ7Y3Ehow16Nzf2v0xrs3k8NihgXFnDuOCf97bow1xT%2BNV53O3Z9VzkuiGxieeYO%2Bxmp34Rs46xRezd3%2FCTXRHEX%2FNm55NPYKWvO%2BCvNcIkeQFspwhrwxhlrxQQozIK3NE3oRUDeFtN0LFuDv%2BPvk0HNzfVcDuvpGLS1WhzGhsju9H1ct9sYejFIzpbV7BDii4lB3VrG%2FFtzsoYZLy%2F%2Fhavp1hWQICbypSsnSTc%2BgGNIUR3RT%2B6BbZL7exYTUx%2B6Ov9lBs2J2Lqj2rcNso1Y3UpBnJS4NtbVr2vBv2AKirBH0AzDOuZHTJaa3KIX4aMamldcAKvEgbomK5j92ePbk1v0Wouo9sVKKUdLzUqPuXXbbQYGjZw0n%2F%2FvYGgy1bhv9n1NLsDJpJOinS4UnhvkSngUuaUhqHLLO%2Fje3%2BZs4iNM3Samx9GpQVlTFkDhLtuPHEf1u01DiDGhqkBSagZbmB8rghaYy4gTjkRvyrLDYy9lSmSgZM7AOsPk0bDLufun2zNznjHGdCbnPlnRFVSbfvDu3OeDD8fpJgb9k9e9wK9u8SqNdQ0UhJC08V9%2BeUUq5grzPiqc4hT0mpuyFkrS5F8RrPUX5%2B2VqK7wRslCcSqtn5Za4jkt380uCQa6k83QSt%2FgSTMa3%2FqbJ8rq2nqof9ifc3k8xFy%2BAqx3DrDTr%2FPWi3tV6Elot5M2hFJ50IkoayYDS0HDDqrCbQOMqZKzIO7f9Ecyrbij6YI9H1t2NezOPKW3kuUg3XanXvlTQSjrBNUYPDJ%2Fa1OkO%2FpL8ScBTqT%2FjpxOYLr%2FNC%2FluuJcwZhJFVg%2FQGcBDoDyA%2FhImjyVuwXEJwsuxRZ9i9206lT7jwfvkWbO8ebIZGuzmVrCwPkXxJ%2BQpwFEifLJMhIirFBt2mRpUWLu0aIF%2BCOoac%2B5E9nAwHvZO8pcfDt9qVQS3S9pAGFV0mkaZmTTVZytOd2BGNo%2BD5zYBuBMnOW45ZBYIRUj6bo4lpWZOb%2B%2FGYXtjTRp%2B2NDpEI1kjY%2BnTkLGjYWR4bXn9NOIolh57qMQmEa%2BTR%2F5brmXL6WwxFHAcLRfWpDgKbT%2B0IE5s1KS1OnEKV91WOn8VdjuLa9lW3adHhYv%2B%2FhXQgKP4%2BwzcGhVFUMNa5jY4oAVJ%2FK2m0GuZ8%2BQglCcHMVvHAzgKPKdDBBsCjorW0RlWUfWiZ%2Bjhaf1OU%2BK7%2Fbv78allR5Nbs2%2BZu9U%2FR%2BWvqEhEX2sy6PfKFmFiKpbanadV5N7HDwJQqYB9Fa8vOqbIQYPZDwJHEfspYoam1R1MBnfiy3NnxN7vN0KVGe%2B2QMm9DflvwRY4Z7gAVCrGwpCzgfBQywuxYLdJrMQjcBo5hWU5dc0vWd4%2B5L8ZW%2FCcs4eFLpFzXwnkeAj0i8bFp9XgiTzR73TXMt%2B1obNrgtMKnTaptIfDwaGVjcfKdgb90XhodqM5eLuHdMvHEwwzST6%2BJUVkreXgkdkKRQj5wWNzJoBtfEbLl9%2FAF4S3s8F8gb990RDkKLa%2BUfO9OhGTt1lCOca02yy8N8ggidxmQTVytimEee5NdozhKNq9KTO71oJp4fI71tIAaoak5vjKLmzBcBS9%2Fui9%2FXLeJuvp3F06k%2FliHfpxDUUGTdQ51gt%2FRY189bD3feaup8HiOcwWiq5%2FsFT49uxmsh%2FMvb0CbetIBeePnsj0x%2FplSYz9fx%2FMvlitQ8fz3Nnk4S17mRLFcOXDxdKN0pbPH7SDpdxXd%2FoSt9ckzl3yDtcv06m7XgsrVO2aKnBWPw5UuiXy8W1UqbhYAKS8qP%2B88AW8MWH9SM6L%2BqeeXm7rxkfu7MkdJfn8IJz7T%2F7K8exd6s3MWc93DyN0gtCM3zS8a2l3NcMpD54%2F%2FbFNwg8dps8CP6ArKKtG%2FC%2FO%2BLoIv8Xn%2FkOVpOT4e1zsDyk9tl6Ti28O3vDBKmq7bdEka5zwfZOggTRhV3hzhEsf7Atr%2FyWYukWtvc0XtcOTGxbkS34n4%2FYt7Fl7%2FUbN%2BSXHaYHrOeHip0vcbF5X2lwheh7O216GZ3%2BxCtd7N3AXJ%2Bz6ta6QvTrpQbteuT3hro%2BmFTij22bjufOj%2BrpWpjvHrdqLh3%2Fcn92Iss7D5iuJBAlFp3yEkZ1z5j46L16Y20WKRx8NkfQt3cm9Xe2%2FCDsPLopG6lVAYhVKD%2FMiYAUnhlSFGCpJDLCPkNqJIZckhi4SMaBCRtUoOtrvlscIQ2VnRJhsXF%2FhairOQYMH7dmgkclnEQ8GNpzBs9CWM5fgjFKSM1hUEAM0QFHJDUV0VSkkDQAGLCrAhjVyNrCmeBkV37BJR%2B7ZsAH0lElHzN4ADZuAm3hciYAbtSxuhKINvW92Yr0dgo2hwoLsjFCTdSLnv0WSc8Tg0Xo2YhgSJc%2BXJhxRUNOIIhZSIKqEFKBoRkF%2BRkzJunVyXi%2FLOVDwYD3fZpENVi%2B9kt%2B7WHtRomgliSKUWAsQJRRCUKy9AAjkogKMkNIMfVeuTd8FikEuCEnfyVc%2FZRoo8PJLGVSSMrJIlLk2yJ07jskutCB8GdWlUOHlny21SbpAJn8SdGa7pyitpntBtOhNNGAoXxCf5ouSFXRFNF%2BU2oRclZqWAsNghZhWx70gYgyxrReip9Ux7rPqqkgmRTp2zh7vUKL8bgarcBSlVVk5HO9AqHgUhdpoUJePeIkRZVRQBRgZFVmZNX%2FTAM4hU5%2FSKkmkMagDZhOXRiivolgV%2BF2%2FopoVB6ghiaCKKAXKqwh0qU9xlWTS9aZDZnRphOIqig1Tmi5QLLxAhfo1VIrxouNbyM%2FPCC9Z0TV3zzTOKVOb9mqoeu5DqB8yagO1V37dOqBs4D5%2BFbAYkIEate8SlIr11%2FhntKgAG8qoWf1199o4vtGi1qa5QllWc5ueAVta0fWSbCkbrC%2BUYwcqlBuST9eOWiDxCqTCpCP2%2FHkSUsjHwM63o7ZaL4%2BYEcyEUTXS5ObUhMmqvcKYMLUpvFDBIzxlC6vYWrURCi%2FQkBhsKRtcK5QfCUg62V15XNisFgq8oi1sVuvbQQGRM9t0JUX9qGmE3KvLcrNQA8SSe2XKKjnGmox0cxnaZPXew%2B%2B05Rw19QXc6tR7rNixRmug6tsE1gglzWR2RVCSF48clGYkFRQVYMMarWAbBQH4otWm%2FBoqZVfiblI%2FXhoh%2FAqjyJRdLCTWLi0GLIxz4WSTFi0r%2FIq8SUs6cs%2BmDQIkbaJZsMwKN40QgIXxM5XFjViBMggv%2FOM5TkbLyr8CxslotSnBCFAPAbCKk9EaIQQLM2Nq5CLFzAIBRTviy9YgrT5WLMCnt1xrxj4OWo37OGjUY2A3N2tlZh5Bhn%2B4BCGZXlVmTneEvaTMrB2QmUViTG3yMpSovWLYycuoEfKyMF7z0owRy1rScK%2FB%2FRUdsWUy8jK6AGOQ2PIyqk1eBul7x1N9mRlfGqEvCyP4NHN5N9TkwuXanKzvRgUCs0B2TDpk67BjqMVRzNZ3o0YIy8L4scpyBj8FQTiDtIoLvHUcOn1JRxbKkZb3XhcvBGPqizBGtLqP%2B1z9jGmEsCwKY%2FCbTRtmywDdoN6Iwactk9V9hbRl6tN9Eb1XDbP9e1EjdF9R5kylOSOWkxwg6uUkXHrJUSN2k0D1BRarVOSfrrIKxdEbofySlKmwnQQBlS2hdA2yowxopDUTvwKZ6K9Iu8D7SvQCIVcg40SvT9A1dNKoRIiVoIsXyImNDXQqNi5tnJTFBhTKKR2v4Sb7a7JT9WGnNCwswIgzWUH3i9nrWqYoMks6WGvYi0ajQH%2FC%2B6mjw8D3w%2F2HFDjP81t%2FFjeW%2FX8%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22vYGWXNYezrYDNnuVoNH6%22%20name%3D%22Page-2%22%3E5VvZcqM4FP0aP3YKJNbHxElmqSSdKU%2FVJE9TMshG3YA8Qt7660cYYfaY2GDoar8EXSQhju45urooEzgNdr8xtPKeqYv9CVDc3QTeTwBQoaKKP7FlLy2KAhLLkhFX2jLDjPzAaUVpXRMXR4WKnFKfk1XR6NAwxA4v2BBjdFustqB%2B8akrtMQVw8xBftX6D3G5J62qYWc3fsdk6clHW8BMbgQorSzfJPKQS7c5E3yYwCmjlCdXwW6K%2FRi9FJek3WPD3ePAGA55mwb%2FfZ2%2BvTz8%2FUbwtxf617%2FG9k%2Fy8kWTY%2BP79IWxK95fFinjHl3SEPkPmfWO0XXo4rhXRZSyOk%2BUroRRFcZvmPO9nEy05lSYPB748i7eEf6Wu36Pu7rRZel%2BJ3s%2BFPZpIeRs%2F5Yv5FrFxazZoZS2W%2Fh0exsSMRuEhvKZC%2BL7U%2BpTdnhjOJ0%2BPtq2sCdYxAA0QixNEV0zB3%2BAa%2BqqiC0x%2F6AeODqCoBCmARZjF%2B0Y9sWAN8VxIOnKy2O9bLbFhZzwT0y%2B7HeD%2FLV80jNxGJ1htiGOIF3ZNbKJj1HceoTj2QodcNgK%2Bhcn%2BWOQN5hxvPsY5iossgFQJKVSUdFleZtjaEo7L0dOQ%2BkJSf1noVEdHY7U%2BqLcKIpR5Bc0tRMMO5ReMSMCSsyksUMqgZZUgoNSCQ7iAUdRvNHswsTFUwlPaWPtzA0kmG1nWdUunGbZ9JUSMcSjpGhaUVKAWZKKZGCyVclZjsM4339ARYpvN4j4aC4cpSLDHg3m62hQCYZmSYK1qgRbNQps9aXAsLqW4ShCSxIuhXm2jzgOOl3QXISthSPsEWf0O87dMRwLzxfd4KyDIs52zUqn1eAMtL6AVu0h17psfXvP3TkVMmZR4ntBCD8jiw1cqpPLDmXRbCuL1pCrn1lVr7VLYnmd0iAQuFxEvB4iRg3UyFUdj3qj0bAs6ipiVCelYPGskKNDvlg%2FRbBYXe2nNIzWQXWtj0F5QnPsFycS%2BWQZT4YjAIphvIvZQRzk38obAXHdxGdwRH4cwogE61UcwRxeSL%2Bb6Pcf0UumVGTjyTGRkZ%2BXZt9u5GIcmgLLKPAx3YqeG8WlVehiEeF%2BArRBt3ifWfaaVqpzl8OeV7i2jAX9BP5C9W%2BAqujAgKpuWnbRLwG87jYgfdz4Ewnn5uPGFFy1dr0GQbvOamE1Ble3r38MHlmZ1thycaoxrFJrlpnX6jSl1swkUWiThMnpN9CscrJHxBTDRl6q1pJNZi86rqmlCF%2B5rnKnr5%2Bj6QyJtwHKcxRnIIS%2FAMVFHB08k7KatM4FyYhYLztL7ehFJGHNXqmW0XpvjK5K4P1dBb%2FIQ6v40tn7RADJ4GkU5wnkT%2FOjATnfl4eJ%2BLrmohss7VFCe1Wvgz7%2BdZTtsYvQ62oVeuOaWTVQ49WOh921LyRkrA5cXpIANAZ2YGD%2FIg5sl6OBmrTwVR0YVr9xduy33YFnlMCDNeyHVw2loDVkKHWV4wENOw8XRd7RJXrehkDQMnKCl26BL3OGatbqEXPHE6YFIr5AS%2BCxwTK8GiXB7NORjX3NJDAcNAv8y%2FCr7c4E6oPyqxprPQtyyK3DuJllKaeZVfc5uD9m6RUwk%2B3YSAG002ORYwFQUytYjV6ainlt9YQ0jSkTmbpr%2F6nI%2BuyJXcqeqHZ8FCz7lTpM3qeSS6l2a3%2Bq255TNNrQZ7QMaJbTdtDo20vP%2BYQ0RHDbT1rQLJ3rguW9UltXVpUSRYRlSF8e5uB2%2FryhXvZl9ayTouf5smaDYpJdPXEWqCbJ3qGXg9YhZkMYcOlXzHQnkTqnfbablw6cAdCPm4ti9q8PSfXsP0jgw%2F8%3D%3C%2Fdiagram%3E%3C%2Fmxfile%3E 

## Technologies

* Language: java
* Core framework: Spring Boot 2 with Spring Framework 5
* Web framework: Spring MVC
* Persistence : MongoDB Data JPA
* Databases: MongoDB , MySql , TestContainers
* Build: Gradle Script
* Testing: Junit 5, Mockito
* Messaging: Rabbit MQ

## Prerequisites

You need rabbitmq in order to run this solution. In order to do this run it either with docker or Kubernetes/Openshit

### Docker

You can use this docker compose https://github.com/simon-atta/docker-compose/tree/master/rabbitmq to start rabbitmq instance.

### Kubernetes/Openshit

You can use helm chart https://github.com/simon-atta/helm/tree/master/rabbitmq

## Running site configuration locally

### With gradle command line

```
git clone https://github.com/simon-atta/audit
cd audit-service
./gradlew bootRun
```



You can then access site configuration here: [http://localhost:8080/]()
